<!doctype html>
<html lang="en">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>App Grid</title>
  <style>
  /* Filters panel */
  #filtersPanel {
    display: none;
    margin-top: 8px;
    padding: 10px;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    background: #fff;
    box-shadow: 0 2px 10px rgba(0,0,0,.06);
  }
  #filtersHost {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
  }
  .chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    border: 1px solid #e5e7eb;
    border-radius: 999px;
    padding: 6px 10px;
    cursor: pointer;
    user-select: none;
    font-size: 14px;
  }

  /* Make iframe content vertical-only; no horizontal swipe */
  html, body { overflow-x: hidden; touch-action: pan-y pinch-zoom; }
  #scroller {
    background: #e7d4bb; /* only the grid area */
    overflow-y: auto; overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    touch-action: pan-y; -ms-touch-action: pan-y;
  }
</style>
<body style="margin:0;background:#f8fafc;color:#0f172a;font:16px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;">

<div style="height:100vh;display:flex;flex-direction:column;">
<!-- Sticky search + filters -->
<div style="position:sticky;top:0;background:#f8fafc;padding:10px;border-bottom:1px solid #ccc;z-index:10;">
  <div style="display:flex;gap:8px;align-items:center;">
    <input id="q" type="search" placeholder="Search apps..." autocomplete="off"
           style="flex:1;padding:8px;border:1px solid #ccc;border-radius:4px; font-size:16px;">
    <button type="button" id="filterBtn"
            style="padding:8px 10px;border:1px solid #ccc;border-radius:4px;cursor:pointer;background:#fff;">
      Filters
    </button>
    <button type="button" id="clearBtn"
            style="padding:8px 10px;border:1px solid #ccc;border-radius:4px;cursor:pointer;background:#fff;">
      Clear
    </button>
  </div>
  <div id="count" style="font-size:12px;color:#666;margin-top:4px;">0 apps</div>

  <div id="filtersPanel">
    <div id="filtersHost"></div>
    <div style="margin-top:8px;display:flex;gap:8px;align-items:center;">
      <button type="button" id="filtersClear"
              style="padding:6px 10px;border:1px solid #ccc;border-radius:6px;background:#fff;cursor:pointer;">
        Clear filters
      </button>
      <div id="filtersSummary" style="font-size:12px;color:#555;"></div>
    </div>
  </div>
</div>

  <!-- === disable horizontal gestures/overflow inside the iframe === -->
<style>
  /* Global: no horizontal overflow, vertical scroll + pinch only */
  html, body {
    overflow-x: hidden;
    touch-action: pan-y pinch-zoom;
  }

  /* The scrollable area around your grid */
  #scroller {
    overflow-y: auto;
    overflow-x: hidden;                 /* kill sideways scrollbars */
    touch-action: pan-y;                /* ignore horizontal swipes */
    -ms-touch-action: pan-y;
    -webkit-overflow-scrolling: touch;  /* smooth iOS scrolling */
    overscroll-behavior-x: none;        /* no horizontal rubberband */
  }

  /* Optional niceties */
  #scroller img {
    user-select: none;
    -webkit-user-drag: none;
  }
</style>

  <!-- Scrollable grid -->
  <div id="scroller" style="flex:1;overflow:auto;padding:10px;">
    <div id="grid" style="display:grid;grid-template-columns:repeat(2,180px);justify-content:center;gap:0;margin:0;padding:0;">

      <!-- ===== 64 blocks (edit href/src/data-name as needed) ===== -->
      <div class="col" style="width:180px;height:180px;"><a href="https://go.viiision.app/topic/67db6cc10a638902a507d43f" target="_blank" data-name="1000 Springs Mill" data-tags="Business Card, Services"><img src="https://storage.googleapis.com/liii/SDAssets/Viiision%20Builds/1000%20Springs%20Mill.png" alt="1000 Springs Mill" loading="lazy" style="width:180px;height:180px;object-fit:cover;display:block;"></a></div>
      <div class="col" style="width:180px;height:180px;"><a href="https://go.viiision.app/topic/67d84067c378679a25af1680" target="_blank" data-name="Agripack Employee" data-tags="Services"><img src="https://storage.googleapis.com/liii/SDAssets/Viiision%20Builds/Agripack%20Employee%20App.png" alt="Agripack Employee" loading="lazy" style="width:180px;height:180px;object-fit:cover;display:block;"></a></div>

      <div class="col" style="width:180px;height:180px;"><a href="https://go.viiision.app/topic/685058e1817fc1e02100d169" target="_blank" data-name="Agripack Onions" data-tags="Packaged Goods"><img src="https://storage.googleapis.com/liii/SDAssets/Viiision%20Builds/Agripack%20Onion%20App.png" alt="Agripack Onions" loading="lazy" style="width:180px;height:180px;object-fit:cover;display:block;"></a></div>
      <div class="col" style="width:180px;height:180px;"><a href="https://go.viiision.app/topic/6851a89af34e415081518bf9" target="_blank" data-name="Agripack Potatoes" data-tags="Packaged Goods"><img src="https://storage.googleapis.com/liii/SDAssets/Viiision%20Builds/Agripack%20Potato%20App.png" alt="Agripack Potatoes" loading="lazy" style="width:180px;height:180px;object-fit:cover;display:block;"></a></div>

      <div class="col" style="width:180px;height:180px;"><a href="https://go.viiision.app/topic/67e4447b2572441df20d976f" target="_blank" data-name="AI Genius Consulting - Noah Riley" data-tags="Business Card, Services"><img src="https://storage.googleapis.com/liii/SDAssets/Viiision%20Builds/AI%20Genius%20Automations.png" alt="AI Genius Consulting - Noah Riley" loading="lazy" style="width:180px;height:180px;object-fit:cover;display:block;"></a></div>
      <div class="col" style="width:180px;height:180px;"><a href="https://go.viiision.app/topic/6835fbd000481fec710da71e" target="_blank" data-name="Akari Luxury Brand" data-tags="Packaged Goods, Demo"><img src="https://storage.googleapis.com/liii/SDAssets/Viiision%20Builds/Akari%20Luxury%20Brand.png" alt="Akari Luxury Brand" loading="lazy" style="width:180px;height:180px;object-fit:cover;display:block;"></a></div>
      <!-- ===== end 64 ===== -->

    </div>
  </div>
</div>

<script>
(function(){
  // ===== DOM refs =====
  var grid = document.getElementById('grid');
  var q = document.getElementById('q');
  var clearBtn = document.getElementById('clearBtn');
  var countEl = document.getElementById('count');

  // Filters UI
  var filterBtn = document.getElementById('filterBtn');
  var filtersPanel = document.getElementById('filtersPanel');
  var filtersHost = document.getElementById('filtersHost');
  var filtersClear = document.getElementById('filtersClear');
  var filtersSummary = document.getElementById('filtersSummary');

  // ===== config =====
  var MATCH_MODE = 'OR'; // 'OR' (any tag matches) or 'AND' (must include all selected)

  // ===== helpers =====
  function norm(s){ return (s||'').toLowerCase().trim(); }
  function splitTags(s){
    return norm(s).split(',').map(function(t){ return t.trim(); }).filter(Boolean);
  }

  // ===== collect unique tags from your tiles =====
  var allTags = (function collectTags(){
    var tags = new Set();
    var blocks = Array.prototype.slice.call(grid.children);
    for (var i=0;i<blocks.length;i++){
      var a = blocks[i].querySelector('a[data-name]');
      if (!a) continue;
      splitTags(a.getAttribute('data-tags')||'').forEach(function(t){ tags.add(t); });
    }
    return Array.from(tags).sort();
  })();

  // ===== render tag checkboxes =====
  var selectedTags = new Set();
  function renderFilters(){
    filtersHost.innerHTML = '';
    if (allTags.length === 0){
      var hint = document.createElement('div');
      hint.textContent = 'Add data-tags="tag1, tag2" to tiles to enable filters.';
      hint.style.fontSize = '12px';
      hint.style.color = '#666';
      filtersHost.appendChild(hint);
      return;
    }
    allTags.forEach(function(tag){
      var id = 'tag_' + tag.replace(/\s+/g,'_');
      var label = document.createElement('label');
      label.className = 'chip';
      label.setAttribute('for', id);

      var cb = document.createElement('input');
      cb.type = 'checkbox';
      cb.id = id;
      cb.value = tag;
      cb.addEventListener('change', function(){
        if (cb.checked) selectedTags.add(tag);
        else selectedTags.delete(tag);
        apply(); updateFiltersSummary();
      });

      var txt = document.createElement('span');
      txt.textContent = tag;

      label.appendChild(cb);
      label.appendChild(txt);
      filtersHost.appendChild(label);
    });
  }

  function updateFiltersSummary(){
    filtersSummary.textContent =
      selectedTags.size ? Array.from(selectedTags).join(', ') : '(no filters)';
  }

  // ===== core filtering (search + tags) =====
  function apply(){
    var term = norm(q.value);
    var blocks = Array.prototype.slice.call(grid.children);
    var visible = 0;

    for (var i=0;i<blocks.length;i++){
      var block = blocks[i];
      var a = block.querySelector('a[data-name]');
      if (!a){ block.style.display='none'; continue; }

      var hay = norm((a.getAttribute('data-name')||'') + ' ' + (a.getAttribute('data-tags')||''));
      var itemTags = splitTags(a.getAttribute('data-tags')||'');

      var matchesSearch = (!term || hay.indexOf(term) !== -1);
      var matchesTags = true;

      if (selectedTags.size > 0){
        if (MATCH_MODE === 'AND') {
          matchesTags = Array.from(selectedTags).every(function(t){ return itemTags.indexOf(t) !== -1; });
        } else {
          matchesTags = itemTags.some(function(t){ return selectedTags.has(t); });
        }
      }

      var show = matchesSearch && matchesTags;
      block.style.display = show ? 'block' : 'none';
      if (show) visible++;
    }

    countEl.textContent = visible + ' app' + (visible===1?'':'s');
  }

  // ===== events =====
  q.addEventListener('input', apply);

  clearBtn.addEventListener('click', function(){
    q.value = '';
    selectedTags.clear();
    var inputs = filtersHost.querySelectorAll('input[type="checkbox"]');
    for (var i=0;i<inputs.length;i++) inputs[i].checked = false;
    updateFiltersSummary();
    apply();
    q.focus();
  });

  if (filterBtn){
    filterBtn.addEventListener('click', function(){
      var open = filtersPanel.style.display !== 'none';
      filtersPanel.style.display = open ? 'none' : 'block';
    });
  }
  if (filtersClear){
    filtersClear.addEventListener('click', function(){
      selectedTags.clear();
      var inputs = filtersHost.querySelectorAll('input[type="checkbox"]');
      for (var i=0;i<inputs.length;i++) inputs[i].checked = false;
      updateFiltersSummary();
      apply();
    });
  }

  // ===== init =====
  renderFilters();
  updateFiltersSummary();
  apply();

  // ===== vertical-only behavior inside iframe =====
  var scroller = document.getElementById('scroller');
  if (scroller) {
    scroller.addEventListener('wheel', function(e){
      if (Math.abs(e.deltaX) > Math.abs(e.deltaY)) e.preventDefault();
    }, { passive: false });

    scroller.addEventListener('keydown', function(e){
      if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') e.preventDefault();
    });

    // Prevent image drag/ghosting
    var imgs = scroller.querySelectorAll('img');
    for (var j=0;j<imgs.length;j++) imgs[j].setAttribute('draggable', 'false');
  }
})();
</script>
</body>
</html>
